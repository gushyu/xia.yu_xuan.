<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>彩色霓虹爱心</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background-color: #000;
            overflow: hidden;
            width: 100vw;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            font-family: 'Microsoft YaHei', 'SimHei', Arial, sans-serif;
            touch-action: none;
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }
        
        #container {
            position: relative;
            width: 100%;
            height: 100%;
            max-width: 500px; /* 限制最大宽度，保持竖屏比例 */
        }
        
        canvas {
            display: block;
            width: 100%;
            height: 100%;
        }
        
        .hint {
            position: absolute;
            bottom: 20px;
            color: #666;
            font-size: 14px;
            text-align: center;
            width: 100%;
            pointer-events: none;
        }
        
        /* 竖屏提示 */
        @media (orientation: landscape) {
            .orientation-warning {
                display: flex;
            }
        }
        
        .orientation-warning {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            color: white;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            z-index: 100;
            text-align: center;
            padding: 20px;
        }
        
        .orientation-warning p {
            margin-bottom: 20px;
            font-size: 18px;
        }
    </style>
</head>
<body>
    <div id="container">
        <canvas id="heartCanvas"></canvas>
        <div class="hint">彩色霓虹爱心</div>
    </div>
    
    <div class="orientation-warning">
        <p>请将手机旋转至竖屏模式</p>
        <p>以获得最佳体验</p>
    </div>

    <script>
        // 获取Canvas元素和上下文
        const canvas = document.getElementById('heartCanvas');
        const ctx = canvas.getContext('2d');
        
        // 设置Canvas尺寸为全屏
        function resizeCanvas() {
            const container = document.getElementById('container');
            canvas.width = container.clientWidth;
            canvas.height = container.clientHeight;
        }
        
        window.addEventListener('resize', resizeCanvas);
        resizeCanvas();
        
        // 文字数组
        const WORDS = [
            "我爱你", "I love you", "永远爱你", "Forever love", 
            "想你", "Miss you", "抱抱", "Hug", "亲爱的", "Darling",
            "心动了", "Heartbeat", "甜蜜", "Sweet", "幸福", "Happiness",
            "缘分", "Destiny", "唯一", "Only one", "命中注定", "Meant to be",
            "陪伴", "Company", "守护", "Guard", "珍惜", "Cherish"
        ];
        
        // 心形函数 - 恢复原始大小
        function heart(t) {
            const x = 16 * Math.pow(Math.sin(t), 3);
            const y = -(13 * Math.cos(t) - 5 * Math.cos(2*t) - 2 * Math.cos(3*t) - Math.cos(4*t));
            // 恢复原始缩放因子14.3
            return { x: x * 14.3, y: y * 14.3 };
        }
        
        // 预计算心形点
        const heartPoints = [];
        for (let i = 0; i < 800; i++) {
            const angle = i / 800 * Math.PI * 2;
            const point = heart(angle);
            heartPoints.push({
                x: canvas.width/2 + point.x,
                y: canvas.height/2 + point.y - 100 // 恢复原始偏移
            });
        }
        
        // 颜色模式
        const colorModes = [
            { hueBase: 0.0, hueRange: 0.3, speed: 0.05 },   // 红橙黄
            { hueBase: 0.3, hueRange: 0.3, speed: 0.04 },   // 黄绿青
            { hueBase: 0.6, hueRange: 0.3, speed: 0.06 },   // 青蓝紫
            { hueBase: 0.8, hueRange: 0.4, speed: 0.03 },   // 紫红粉
        ];
        
        // 创建文字粒子
        const particles = [];
        for (let i = 0; i < 25; i++) { // 减少粒子数量以适应手机性能
            const colorMode = colorModes[Math.floor(Math.random() * colorModes.length)];
            particles.push({
                word: WORDS[Math.floor(Math.random() * WORDS.length)],
                offset: i * (800 / 25) + Math.random() * 30 - 15,
                hueBase: colorMode.hueBase,
                hueRange: colorMode.hueRange,
                colorSpeed: colorMode.speed,
                pulseSpeed: Math.random() * 0.03 + 0.02,
                brightness: Math.random() * 0.3 + 0.7
            });
        }
        
        // HSV转RGB函数
        function hsvToRgb(h, s, v) {
            let r, g, b;
            
            const i = Math.floor(h * 6);
            const f = h * 6 - i;
            const p = v * (1 - s);
            const q = v * (1 - f * s);
            const t = v * (1 - (1 - f) * s);
            
            switch (i % 6) {
                case 0: r = v; g = t; b = p; break;
                case 1: r = q; g = v; b = p; break;
                case 2: r = p; g = v; b = t; break;
                case 3: r = p; g = q; b = v; break;
                case 4: r = t; g = p; b = v; break;
                case 5: r = v; g = p; b = q; break;
            }
            
            return {
                r: Math.round(r * 255),
                g: Math.round(g * 255),
                b: Math.round(b * 255)
            };
        }
        
        // 动画变量
        let t = 0;
        let animationId;
        
        // 绘制函数
        function draw() {
            // 清屏
            ctx.fillStyle = 'rgba(0, 0, 0, 0.1)';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // 减慢速度 - 减少t的增量
            t += 0.4;
            
            // 绘制所有粒子
            particles.forEach(p => {
                const idx = Math.floor((t + p.offset) % 800);
                const point = heartPoints[idx];
                
                // 计算彩色多元化的颜色
                const hue = (p.hueBase + p.hueRange * Math.sin(t * p.colorSpeed)) % 1.0;
                // 添加呼吸灯效果
                const pulse = 0.2 + 0.8 * (0.5 + 0.5 * Math.sin(t * p.pulseSpeed));
                // 最终颜色
                const rgb = hsvToRgb(hue, 0.9, p.brightness * pulse);
                const mainColor = `rgb(${rgb.r}, ${rgb.g}, ${rgb.b})`;
                
                // 根据主颜色生成发光效果的颜色
                const glowColors = [];
                for (let i = 0; i < 3; i++) {
                    // 发光层使用略微不同的色调
                    const glowHue = (hue + 0.02 * (i+1)) % 1.0;
                    const glowRgb = hsvToRgb(glowHue, 0.7, 0.6 + 0.2*i);
                    glowColors.push(`rgb(${glowRgb.r}, ${glowRgb.g}, ${glowRgb.b})`);
                }
                
                // 设置字体 - 使用相对大小
                const fontSize = Math.min(canvas.width, canvas.height) * 0.04;
                ctx.font = `${fontSize}px "Microsoft YaHei", "SimHei", Arial, sans-serif`;
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                
                // 绘制发光效果
                const glowLayers = [
                    { size: 2, color: glowColors[0] },
                    { size: 1, color: glowColors[1] },
                    { size: 0, color: glowColors[2] }
                ];
                
                glowLayers.forEach(layer => {
                    ctx.fillStyle = layer.color;
                    ctx.fillText(p.word, point.x + layer.size, point.y + layer.size);
                    ctx.fillText(p.word, point.x - layer.size, point.y - layer.size);
                });
                
                // 绘制主文字
                ctx.fillStyle = mainColor;
                ctx.fillText(p.word, point.x, point.y);
            });
            
            // 继续动画
            animationId = requestAnimationFrame(draw);
        }
        
        // 开始动画
        draw();
        
        // 处理窗口失去焦点时暂停动画
        window.addEventListener('blur', function() {
            cancelAnimationFrame(animationId);
        });
        
        window.addEventListener('focus', function() {
            if (!animationId) {
                draw();
            }
        });
        
        // 阻止默认触摸行为（如下拉刷新）
        document.addEventListener('touchmove', function(e) {
            e.preventDefault();
        }, { passive: false });
    </script>
</body>
</html>